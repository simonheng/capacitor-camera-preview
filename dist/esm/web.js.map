{"version":3,"file":"web.js","sourceRoot":"","sources":["../../src/web.ts"],"names":[],"mappings":"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","sourcesContent":["import { WebPlugin } from \"@capacitor/core\";\n\nimport type {\n  CameraDevice,\n  CameraOpacityOptions,\n  CameraPreviewFlashMode,\n  CameraPreviewOptions,\n  CameraPreviewPictureOptions,\n  CameraPreviewPlugin,\n  CameraSampleOptions,\n  DeviceOrientation,\n  GridMode,\n  ExposureMode,\n  FlashMode,\n  LensInfo,\n  SafeAreaInsets,\n} from \"./definitions\";\nimport { DeviceType } from \"./definitions\";\n\nconst DEFAULT_VIDEO_ID = \"capgo_video\";\nexport class CameraPreviewWeb extends WebPlugin implements CameraPreviewPlugin {\n  /**\n   *  track which camera is used based on start options\n   *  used in capture\n   */\n  private isBackCamera = false;\n  private currentDeviceId: string | null = null;\n  private videoElement: HTMLVideoElement | null = null;\n  private isStarted = false;\n  private orientationListenerBound = false;\n\n  constructor() {\n    super();\n  }\n  private getCurrentOrientation(): DeviceOrientation {\n    try {\n      const so: any = (screen as any).orientation;\n      const type = so?.type || so?.mozOrientation || so?.msOrientation;\n      if (typeof type === \"string\") {\n        if (type.includes(\"portrait-primary\")) return \"portrait\";\n        if (type.includes(\"portrait-secondary\")) return \"portrait-upside-down\";\n        if (type.includes(\"landscape-primary\")) return \"landscape-left\";\n        if (type.includes(\"landscape-secondary\")) return \"landscape-right\";\n        if (type.includes(\"landscape\")) return \"landscape-right\"; // avoid generic landscape\n        if (type.includes(\"portrait\")) return \"portrait\";\n      }\n      const angle = (window as any).orientation;\n      if (typeof angle === \"number\") {\n        if (angle === 0) return \"portrait\";\n        if (angle === 180) return \"portrait-upside-down\";\n        if (angle === 90) return \"landscape-right\";\n        if (angle === -90) return \"landscape-left\";\n        if (angle === 270) return \"landscape-left\";\n      }\n      if (window.matchMedia(\"(orientation: portrait)\")?.matches) {\n        return \"portrait\";\n      }\n      if (window.matchMedia(\"(orientation: landscape)\")?.matches) {\n        // Default to landscape-right when we can't distinguish primary/secondary\n        return \"landscape-right\";\n      }\n    } catch (e) {\n      console.error(e);\n    }\n    return \"unknown\";\n  }\n  private ensureOrientationListener() {\n    if (this.orientationListenerBound) return;\n    const emit = () => {\n      this.notifyListeners(\"orientationChange\", {\n        orientation: this.getCurrentOrientation(),\n      });\n    };\n    window.addEventListener(\"orientationchange\", emit);\n    window.addEventListener(\"resize\", emit);\n    this.orientationListenerBound = true;\n  }\n  async getOrientation(): Promise<{ orientation: DeviceOrientation }> {\n    return { orientation: this.getCurrentOrientation() };\n  }\n  getSafeAreaInsets(): Promise<SafeAreaInsets> {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  async getZoomButtonValues(): Promise<{ values: number[] }> {\n    throw new Error(\"getZoomButtonValues not supported under the web platform\");\n  }\n\n  async getSupportedPictureSizes(): Promise<any> {\n    throw new Error(\n      \"getSupportedPictureSizes not supported under the web platform\",\n    );\n  }\n\n  async start(\n    options: CameraPreviewOptions,\n  ): Promise<{ width: number; height: number; x: number; y: number }> {\n    if (options.aspectRatio && (options.width || options.height)) {\n      throw new Error(\n        \"Cannot set both aspectRatio and size (width/height). Use setPreviewSize after start.\",\n      );\n    }\n    if (this.isStarted) {\n      throw new Error(\"camera already started\");\n    }\n\n    this.isBackCamera = true;\n    this.isStarted = false;\n    const parent = document.getElementById(options?.parent || \"\");\n    const gridMode = options?.gridMode || \"none\";\n    const positioning = options?.positioning || \"top\";\n\n    if (options.position) {\n      this.isBackCamera = options.position === \"rear\";\n    }\n\n    const video = document.getElementById(DEFAULT_VIDEO_ID);\n    if (video) {\n      video.remove();\n    }\n    const container = options.parent\n      ? document.getElementById(options.parent)\n      : document.body;\n    if (!container) {\n      throw new Error(\"container not found\");\n    }\n    this.videoElement = document.createElement(\"video\");\n    this.videoElement.id = DEFAULT_VIDEO_ID;\n    this.videoElement.className = options.className || \"\";\n    this.videoElement.playsInline = true;\n    this.videoElement.muted = true;\n    this.videoElement.autoplay = true;\n    // Remove objectFit as we'll match camera's native aspect ratio\n    this.videoElement.style.backgroundColor = \"transparent\";\n    // Reset any default margins that might interfere\n    this.videoElement.style.margin = \"0\";\n    this.videoElement.style.padding = \"0\";\n\n    container.appendChild(this.videoElement);\n    if (options.toBack) {\n      this.videoElement.style.zIndex = \"-1\";\n    }\n\n    // Default to 4:3 if no aspect ratio or size specified\n    const useDefaultAspectRatio =\n      !options.aspectRatio && !options.width && !options.height;\n    const effectiveAspectRatio =\n      options.aspectRatio || (useDefaultAspectRatio ? \"4:3\" : null);\n\n    if (options.width) {\n      this.videoElement.width = options.width;\n      this.videoElement.style.width = `${options.width}px`;\n    }\n\n    if (options.height) {\n      this.videoElement.height = options.height;\n      this.videoElement.style.height = `${options.height}px`;\n    }\n\n    // Handle positioning - center if x or y not provided\n    const centerX = options.x === undefined;\n    const centerY = options.y === undefined;\n\n    // Always set position to absolute for proper positioning\n    this.videoElement.style.position = \"absolute\";\n\n    console.log(\"Initial positioning flags:\", {\n      centerX,\n      centerY,\n      x: options.x,\n      y: options.y,\n    });\n\n    if (options.x !== undefined) {\n      this.videoElement.style.left = `${options.x}px`;\n    }\n\n    if (options.y !== undefined) {\n      this.videoElement.style.top = `${options.y}px`;\n    }\n\n    // Create and add grid overlay if needed\n    if (gridMode !== \"none\") {\n      const gridOverlay = this.createGridOverlay(gridMode);\n      gridOverlay.id = \"camera-grid-overlay\";\n      parent?.appendChild(gridOverlay);\n    }\n\n    // Aspect ratio handling is now done after getting camera stream\n\n    // Store centering flags for later use\n    const needsCenterX = centerX;\n    const needsCenterY = centerY;\n\n    console.log(\"Centering flags stored:\", { needsCenterX, needsCenterY });\n\n    // First get the camera stream with basic constraints\n    const constraints: MediaStreamConstraints = {\n      video: {\n        facingMode: this.isBackCamera ? \"environment\" : \"user\",\n      },\n    };\n\n    const stream = await navigator.mediaDevices.getUserMedia(constraints);\n    if (!stream) {\n      throw new Error(\"could not acquire stream\");\n    }\n    if (!this.videoElement) {\n      throw new Error(\"video element not found\");\n    }\n\n    // Get the actual camera dimensions from the video track\n    const videoTrack = stream.getVideoTracks()[0];\n    const settings = videoTrack.getSettings();\n    const cameraWidth = settings.width || 640;\n    const cameraHeight = settings.height || 480;\n    const cameraAspectRatio = cameraWidth / cameraHeight;\n\n    console.log(\"Camera native dimensions:\", {\n      width: cameraWidth,\n      height: cameraHeight,\n      aspectRatio: cameraAspectRatio,\n    });\n\n    console.log(\"Container dimensions:\", {\n      width: container.offsetWidth,\n      height: container.offsetHeight,\n      id: container.id,\n    });\n\n    // Now adjust video element size based on camera's native aspect ratio\n    if (!options.width && !options.height && !options.aspectRatio) {\n      // No size specified, fit camera view within container bounds\n      const containerWidth = container.offsetWidth || window.innerWidth;\n      const containerHeight = container.offsetHeight || window.innerHeight;\n\n      // Calculate dimensions that fit within container while maintaining camera aspect ratio\n      let targetWidth, targetHeight;\n\n      // Try fitting to container width first\n      targetWidth = containerWidth;\n      targetHeight = targetWidth / cameraAspectRatio;\n\n      // If height exceeds container, fit to height instead\n      if (targetHeight > containerHeight) {\n        targetHeight = containerHeight;\n        targetWidth = targetHeight * cameraAspectRatio;\n      }\n\n      console.log(\"Video element dimensions:\", {\n        width: targetWidth,\n        height: targetHeight,\n        container: { width: containerWidth, height: containerHeight },\n      });\n\n      this.videoElement.width = targetWidth;\n      this.videoElement.height = targetHeight;\n      this.videoElement.style.width = `${targetWidth}px`;\n      this.videoElement.style.height = `${targetHeight}px`;\n\n      // Center the video element within its parent container\n      if (needsCenterX || options.x === undefined) {\n        const x = Math.round((containerWidth - targetWidth) / 2);\n        this.videoElement.style.left = `${x}px`;\n      }\n      if (needsCenterY || options.y === undefined) {\n        let y: number;\n        switch (positioning) {\n          case \"top\":\n            y = 0;\n            break;\n          case \"bottom\":\n            y = window.innerHeight - targetHeight;\n            break;\n          case \"center\":\n          default:\n            y = Math.round((window.innerHeight - targetHeight) / 2);\n            break;\n        }\n        this.videoElement.style.setProperty(\"top\", `${y}px`, \"important\");\n        // Force a style recalculation\n        this.videoElement.offsetHeight;\n        console.log(\"Positioning video:\", {\n          positioning,\n          viewportHeight: window.innerHeight,\n          targetHeight,\n          calculatedY: y,\n          actualTop: this.videoElement.style.top,\n          position: this.videoElement.style.position,\n        });\n      }\n    } else if (effectiveAspectRatio && !options.width && !options.height) {\n      // Aspect ratio specified but no size\n      const [widthRatio, heightRatio] = effectiveAspectRatio\n        .split(\":\")\n        .map(Number);\n      const targetRatio = widthRatio / heightRatio;\n      const viewportWidth = window.innerWidth;\n      const viewportHeight = window.innerHeight;\n\n      let targetWidth, targetHeight;\n\n      // Try fitting to viewport width first\n      targetWidth = viewportWidth;\n      targetHeight = targetWidth / targetRatio;\n\n      // If height exceeds viewport, fit to height instead\n      if (targetHeight > viewportHeight) {\n        targetHeight = viewportHeight;\n        targetWidth = targetHeight * targetRatio;\n      }\n\n      this.videoElement.width = targetWidth;\n      this.videoElement.height = targetHeight;\n      this.videoElement.style.width = `${targetWidth}px`;\n      this.videoElement.style.height = `${targetHeight}px`;\n\n      // Center the video element within its parent container\n      if (needsCenterX || options.x === undefined) {\n        const parentWidth = container.offsetWidth || viewportWidth;\n        const x = Math.round((parentWidth - targetWidth) / 2);\n        this.videoElement.style.left = `${x}px`;\n      }\n      if (needsCenterY || options.y === undefined) {\n        const parentHeight = container.offsetHeight || viewportHeight;\n        let y: number;\n        switch (positioning) {\n          case \"top\":\n            y = 0;\n            break;\n          case \"bottom\":\n            y = parentHeight - targetHeight;\n            break;\n          case \"center\":\n          default:\n            y = Math.round((parentHeight - targetHeight) / 2);\n            break;\n        }\n        this.videoElement.style.top = `${y}px`;\n      }\n    }\n\n    this.videoElement.srcObject = stream;\n    if (!this.isBackCamera) {\n      this.videoElement.style.transform = \"scaleX(-1)\";\n    }\n\n    // Set initial zoom level if specified and supported\n    if (\n      options.initialZoomLevel !== undefined &&\n      options.initialZoomLevel !== 1.0\n    ) {\n      // videoTrack already declared above\n      if (videoTrack) {\n        const capabilities = videoTrack.getCapabilities() as any;\n\n        if (capabilities.zoom) {\n          const zoomLevel = options.initialZoomLevel;\n          const minZoom = capabilities.zoom.min || 1;\n          const maxZoom = capabilities.zoom.max || 1;\n\n          if (zoomLevel < minZoom || zoomLevel > maxZoom) {\n            stream.getTracks().forEach((track) => track.stop());\n            throw new Error(\n              `Initial zoom level ${zoomLevel} is not available. Valid range is ${minZoom} to ${maxZoom}`,\n            );\n          }\n\n          try {\n            await videoTrack.applyConstraints({\n              advanced: [{ zoom: zoomLevel } as any],\n            });\n          } catch (error) {\n            console.warn(`Failed to set initial zoom level: ${error}`);\n            // Don't throw, just continue without zoom\n          }\n        }\n      }\n    }\n\n    this.isStarted = true;\n    this.ensureOrientationListener();\n\n    // Wait for video to be ready and get actual dimensions\n    await new Promise<void>((resolve) => {\n      const videoEl = this.videoElement;\n      if (!videoEl) {\n        throw new Error(\"video element not found\");\n      }\n      if (videoEl.readyState >= 2) {\n        resolve();\n      } else {\n        videoEl.addEventListener(\"loadeddata\", () => resolve(), {\n          once: true,\n        });\n      }\n    });\n\n    // Ensure centering is applied after DOM updates\n    await new Promise((resolve) => requestAnimationFrame(resolve));\n\n    console.log(\"About to re-center, flags:\", { needsCenterX, needsCenterY });\n\n    // Re-apply centering with correct parent dimensions\n    if (needsCenterX) {\n      const parentWidth = container.offsetWidth;\n      const x = Math.round((parentWidth - this.videoElement.offsetWidth) / 2);\n      this.videoElement.style.left = `${x}px`;\n      console.log(\"Re-centering X:\", {\n        parentWidth,\n        videoWidth: this.videoElement.offsetWidth,\n        x,\n      });\n    }\n    if (needsCenterY) {\n      let y: number;\n      switch (positioning) {\n        case \"top\":\n          y = 0;\n          break;\n        case \"bottom\":\n          y = window.innerHeight - this.videoElement.offsetHeight;\n          break;\n        case \"center\":\n        default:\n          y = Math.round(\n            (window.innerHeight - this.videoElement.offsetHeight) / 2,\n          );\n          break;\n      }\n      this.videoElement.style.setProperty(\"top\", `${y}px`, \"important\");\n      console.log(\"Re-positioning Y:\", {\n        positioning,\n        viewportHeight: window.innerHeight,\n        videoHeight: this.videoElement.offsetHeight,\n        y,\n        position: this.videoElement.style.position,\n        top: this.videoElement.style.top,\n      });\n    }\n\n    // Get the actual rendered dimensions after video is loaded\n    const rect = this.videoElement.getBoundingClientRect();\n    const computedStyle = window.getComputedStyle(this.videoElement);\n\n    console.log(\"Final video element state:\", {\n      rect: { x: rect.x, y: rect.y, width: rect.width, height: rect.height },\n      style: {\n        position: computedStyle.position,\n        left: computedStyle.left,\n        top: computedStyle.top,\n        width: computedStyle.width,\n        height: computedStyle.height,\n      },\n    });\n\n    return {\n      width: Math.round(rect.width),\n      height: Math.round(rect.height),\n      x: Math.round(rect.x),\n      y: Math.round(rect.y),\n    };\n  }\n\n  private stopStream(stream: any) {\n    if (stream) {\n      const tracks = stream.getTracks();\n\n      for (const track of tracks) track.stop();\n    }\n  }\n\n  async stop(): Promise<void> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (video) {\n      video.pause();\n\n      this.stopStream(video.srcObject);\n\n      video.remove();\n      this.isStarted = false;\n    }\n\n    // Remove grid overlay if it exists\n    const gridOverlay = document.getElementById(\"camera-grid-overlay\");\n    gridOverlay?.remove();\n  }\n\n  async capture(options: CameraPreviewPictureOptions): Promise<any> {\n    return new Promise((resolve, reject) => {\n      const video = document.getElementById(\n        DEFAULT_VIDEO_ID,\n      ) as HTMLVideoElement;\n      if (!video?.srcObject) {\n        reject(new Error(\"camera is not running\"));\n        return;\n      }\n\n      // video.width = video.offsetWidth;\n\n      let base64EncodedImage;\n\n      if (video && video.videoWidth > 0 && video.videoHeight > 0) {\n        const canvas = document.createElement(\"canvas\");\n        const context = canvas.getContext(\"2d\");\n\n        // Calculate capture dimensions\n        let captureWidth = video.videoWidth;\n        let captureHeight = video.videoHeight;\n        const sourceX = 0;\n        const sourceY = 0;\n\n        // If width or height is specified, resize to fit within both maximums while maintaining aspect ratio\n        if (options.width || options.height) {\n          const originalAspectRatio = video.videoWidth / video.videoHeight;\n          const targetWidth = options.width || video.videoWidth;\n          const targetHeight = options.height || video.videoHeight;\n\n          // Calculate dimensions that fit within both maximums\n          if (options.width && options.height) {\n            // Both dimensions specified - fit within both\n            const maxAspectRatio = targetWidth / targetHeight;\n            if (originalAspectRatio > maxAspectRatio) {\n              // Original is wider - fit by width\n              captureWidth = targetWidth;\n              captureHeight = targetWidth / originalAspectRatio;\n            } else {\n              // Original is taller - fit by height\n              captureWidth = targetHeight * originalAspectRatio;\n              captureHeight = targetHeight;\n            }\n          } else if (options.width) {\n            // Only width specified - maintain aspect ratio\n            captureWidth = targetWidth;\n            captureHeight = targetWidth / originalAspectRatio;\n          } else {\n            // Only height specified - maintain aspect ratio\n            captureWidth = targetHeight * originalAspectRatio;\n            captureHeight = targetHeight;\n          }\n        }\n\n        canvas.width = captureWidth;\n        canvas.height = captureHeight;\n\n        // flip horizontally back camera isn't used\n        if (!this.isBackCamera) {\n          context?.translate(captureWidth, 0);\n          context?.scale(-1, 1);\n        }\n        context?.drawImage(\n          video,\n          sourceX,\n          sourceY,\n          captureWidth,\n          captureHeight,\n          0,\n          0,\n          captureWidth,\n          captureHeight,\n        );\n\n        if (options.saveToGallery) {\n          // saveToGallery is not supported on web\n        }\n\n        if (options.withExifLocation) {\n          // withExifLocation is not supported on web\n        }\n\n        if ((options.format || \"jpeg\") === \"jpeg\") {\n          base64EncodedImage = canvas\n            .toDataURL(\"image/jpeg\", (options.quality || 85) / 100.0)\n            .replace(\"data:image/jpeg;base64,\", \"\");\n        } else {\n          base64EncodedImage = canvas\n            .toDataURL(\"image/png\")\n            .replace(\"data:image/png;base64,\", \"\");\n        }\n      }\n\n      resolve({\n        value: base64EncodedImage,\n        exif: {},\n      });\n    });\n  }\n\n  async captureSample(_options: CameraSampleOptions): Promise<any> {\n    return this.capture(_options);\n  }\n\n  async stopRecordVideo(): Promise<any> {\n    throw new Error(\"stopRecordVideo not supported under the web platform\");\n  }\n\n  async startRecordVideo(_options: CameraPreviewOptions): Promise<any> {\n    console.log(\"startRecordVideo\", _options);\n    throw new Error(\"startRecordVideo not supported under the web platform\");\n  }\n\n  async getSupportedFlashModes(): Promise<{\n    result: CameraPreviewFlashMode[];\n  }> {\n    throw new Error(\n      \"getSupportedFlashModes not supported under the web platform\",\n    );\n  }\n\n  async getHorizontalFov(): Promise<{\n    result: any;\n  }> {\n    throw new Error(\"getHorizontalFov not supported under the web platform\");\n  }\n\n  async setFlashMode(_options: {\n    flashMode: CameraPreviewFlashMode | string;\n  }): Promise<void> {\n    throw new Error(\n      `setFlashMode not supported under the web platform${_options}`,\n    );\n  }\n\n  async flip(): Promise<void> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video?.srcObject) {\n      throw new Error(\"camera is not running\");\n    }\n\n    // Stop current stream\n    this.stopStream(video.srcObject);\n\n    // Toggle camera position\n    this.isBackCamera = !this.isBackCamera;\n\n    // Get new constraints\n    const constraints: MediaStreamConstraints = {\n      video: {\n        facingMode: this.isBackCamera ? \"environment\" : \"user\",\n        width: { ideal: video.videoWidth || 640 },\n        height: { ideal: video.videoHeight || 480 },\n      },\n    };\n\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      video.srcObject = stream;\n\n      // Update current device ID from the new stream\n      const videoTrack = stream.getVideoTracks()[0];\n      if (videoTrack) {\n        this.currentDeviceId = videoTrack.getSettings().deviceId || null;\n      }\n\n      // Update video transform based on camera\n      if (this.isBackCamera) {\n        video.style.transform = \"none\";\n        video.style.webkitTransform = \"none\";\n      } else {\n        video.style.transform = \"scaleX(-1)\";\n        video.style.webkitTransform = \"scaleX(-1)\";\n      }\n\n      await video.play();\n    } catch (error) {\n      throw new Error(`Failed to flip camera: ${error}`);\n    }\n  }\n\n  async setOpacity(_options: CameraOpacityOptions): Promise<any> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!!video && !!_options.opacity)\n      video.style.setProperty(\"opacity\", _options.opacity.toString());\n  }\n\n  async isRunning(): Promise<{ isRunning: boolean }> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    return { isRunning: !!video && !!video.srcObject };\n  }\n\n  async getAvailableDevices(): Promise<{ devices: CameraDevice[] }> {\n    if (!navigator.mediaDevices?.enumerateDevices) {\n      throw new Error(\n        \"getAvailableDevices not supported under the web platform\",\n      );\n    }\n\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    const videoDevices = devices.filter(\n      (device) => device.kind === \"videoinput\",\n    );\n\n    // Group devices by position (front/back)\n    const frontDevices: any[] = [];\n    const backDevices: any[] = [];\n\n    videoDevices.forEach((device, index) => {\n      const label = device.label || `Camera ${index + 1}`;\n      const labelLower = label.toLowerCase();\n\n      // Determine device type based on label\n      let deviceType: DeviceType = DeviceType.WIDE_ANGLE;\n      let baseZoomRatio = 1.0;\n\n      if (labelLower.includes(\"ultra\") || labelLower.includes(\"0.5\")) {\n        deviceType = DeviceType.ULTRA_WIDE;\n        baseZoomRatio = 0.5;\n      } else if (\n        labelLower.includes(\"telephoto\") ||\n        labelLower.includes(\"tele\") ||\n        labelLower.includes(\"2x\") ||\n        labelLower.includes(\"3x\")\n      ) {\n        deviceType = DeviceType.TELEPHOTO;\n        baseZoomRatio = 2.0;\n      } else if (\n        labelLower.includes(\"depth\") ||\n        labelLower.includes(\"truedepth\")\n      ) {\n        deviceType = DeviceType.TRUE_DEPTH;\n        baseZoomRatio = 1.0;\n      }\n\n      const lensInfo = {\n        deviceId: device.deviceId,\n        label,\n        deviceType,\n        focalLength: 4.25,\n        baseZoomRatio,\n        minZoom: 1.0,\n        maxZoom: 1.0,\n      };\n\n      // Determine position and add to appropriate array\n      if (labelLower.includes(\"back\") || labelLower.includes(\"rear\")) {\n        backDevices.push(lensInfo);\n      } else {\n        frontDevices.push(lensInfo);\n      }\n    });\n\n    const result: CameraDevice[] = [];\n\n    if (frontDevices.length > 0) {\n      result.push({\n        deviceId: frontDevices[0].deviceId,\n        label: \"Front Camera\",\n        position: \"front\",\n        lenses: frontDevices,\n        isLogical: false,\n        minZoom: Math.min(...frontDevices.map((d) => d.minZoom)),\n        maxZoom: Math.max(...frontDevices.map((d) => d.maxZoom)),\n      });\n    }\n\n    if (backDevices.length > 0) {\n      result.push({\n        deviceId: backDevices[0].deviceId,\n        label: \"Back Camera\",\n        position: \"rear\",\n        lenses: backDevices,\n        isLogical: false,\n        minZoom: Math.min(...backDevices.map((d) => d.minZoom)),\n        maxZoom: Math.max(...backDevices.map((d) => d.maxZoom)),\n      });\n    }\n\n    return { devices: result };\n  }\n\n  async getZoom(): Promise<{\n    min: number;\n    max: number;\n    current: number;\n    lens: LensInfo;\n  }> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video?.srcObject) {\n      throw new Error(\"camera is not running\");\n    }\n\n    const stream = video.srcObject as MediaStream;\n    const videoTrack = stream.getVideoTracks()[0];\n\n    if (!videoTrack) {\n      throw new Error(\"no video track found\");\n    }\n\n    const capabilities = videoTrack.getCapabilities() as any;\n    const settings = videoTrack.getSettings() as any;\n\n    if (!capabilities.zoom) {\n      throw new Error(\"zoom not supported by this device\");\n    }\n\n    // Get current device info to determine lens type\n    let deviceType: DeviceType = DeviceType.WIDE_ANGLE;\n    let baseZoomRatio = 1.0;\n\n    if (this.currentDeviceId) {\n      const devices = await navigator.mediaDevices.enumerateDevices();\n      const device = devices.find((d) => d.deviceId === this.currentDeviceId);\n      if (device) {\n        const labelLower = device.label.toLowerCase();\n        if (labelLower.includes(\"ultra\") || labelLower.includes(\"0.5\")) {\n          deviceType = DeviceType.ULTRA_WIDE;\n          baseZoomRatio = 0.5;\n        } else if (\n          labelLower.includes(\"telephoto\") ||\n          labelLower.includes(\"tele\") ||\n          labelLower.includes(\"2x\") ||\n          labelLower.includes(\"3x\")\n        ) {\n          deviceType = DeviceType.TELEPHOTO;\n          baseZoomRatio = 2.0;\n        } else if (\n          labelLower.includes(\"depth\") ||\n          labelLower.includes(\"truedepth\")\n        ) {\n          deviceType = DeviceType.TRUE_DEPTH;\n          baseZoomRatio = 1.0;\n        }\n      }\n    }\n\n    const currentZoom = settings.zoom || 1;\n    const lensInfo: LensInfo = {\n      focalLength: 4.25,\n      deviceType,\n      baseZoomRatio,\n      digitalZoom: currentZoom / baseZoomRatio,\n    };\n\n    return {\n      min: capabilities.zoom.min || 1,\n      max: capabilities.zoom.max || 1,\n      current: currentZoom,\n      lens: lensInfo,\n    };\n  }\n\n  async setZoom(options: {\n    level: number;\n    ramp?: boolean;\n    autoFocus?: boolean;\n  }): Promise<void> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video?.srcObject) {\n      throw new Error(\"camera is not running\");\n    }\n\n    const stream = video.srcObject as MediaStream;\n    const videoTrack = stream.getVideoTracks()[0];\n\n    if (!videoTrack) {\n      throw new Error(\"no video track found\");\n    }\n\n    const capabilities = videoTrack.getCapabilities() as any;\n\n    if (!capabilities.zoom) {\n      throw new Error(\"zoom not supported by this device\");\n    }\n\n    const zoomLevel = Math.max(\n      capabilities.zoom.min || 1,\n      Math.min(capabilities.zoom.max || 1, options.level),\n    );\n\n    // Note: autoFocus is not supported on web platform\n\n    try {\n      await videoTrack.applyConstraints({\n        advanced: [{ zoom: zoomLevel } as any],\n      });\n    } catch (error) {\n      throw new Error(`Failed to set zoom: ${error}`);\n    }\n  }\n\n  async getFlashMode(): Promise<{ flashMode: FlashMode }> {\n    throw new Error(\"getFlashMode not supported under the web platform\");\n  }\n\n  async getDeviceId(): Promise<{ deviceId: string }> {\n    return { deviceId: this.currentDeviceId || \"\" };\n  }\n\n  async setDeviceId(options: { deviceId: string }): Promise<void> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video?.srcObject) {\n      throw new Error(\"camera is not running\");\n    }\n\n    // Stop current stream\n    this.stopStream(video.srcObject);\n\n    // Update current device ID\n    this.currentDeviceId = options.deviceId;\n\n    // Get new constraints with specific device ID\n    const constraints: MediaStreamConstraints = {\n      video: {\n        deviceId: { exact: options.deviceId },\n        width: { ideal: video.videoWidth || 640 },\n        height: { ideal: video.videoHeight || 480 },\n      },\n    };\n\n    try {\n      // Try to determine camera position from device\n      const devices = await navigator.mediaDevices.enumerateDevices();\n      const device = devices.find((d) => d.deviceId === options.deviceId);\n      this.isBackCamera =\n        device?.label.toLowerCase().includes(\"back\") ||\n        device?.label.toLowerCase().includes(\"rear\") ||\n        false;\n\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      video.srcObject = stream;\n\n      // Update video transform based on camera\n      if (this.isBackCamera) {\n        video.style.transform = \"none\";\n        video.style.webkitTransform = \"none\";\n      } else {\n        video.style.transform = \"scaleX(-1)\";\n        video.style.webkitTransform = \"scaleX(-1)\";\n      }\n\n      await video.play();\n    } catch (error) {\n      throw new Error(`Failed to swap to device ${options.deviceId}: ${error}`);\n    }\n  }\n\n  async getAspectRatio(): Promise<{ aspectRatio: \"4:3\" | \"16:9\" }> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video) {\n      throw new Error(\"camera is not running\");\n    }\n\n    const width = video.offsetWidth;\n    const height = video.offsetHeight;\n\n    if (width && height) {\n      const ratio = width / height;\n      // Check for portrait camera ratios: 4:3 -> 3:4, 16:9 -> 9:16\n      if (Math.abs(ratio - 3 / 4) < 0.01) {\n        return { aspectRatio: \"4:3\" };\n      }\n      if (Math.abs(ratio - 9 / 16) < 0.01) {\n        return { aspectRatio: \"16:9\" };\n      }\n    }\n\n    // Default to 4:3 if no specific aspect ratio is matched\n    return { aspectRatio: \"4:3\" };\n  }\n\n  async setAspectRatio(options: {\n    aspectRatio: \"4:3\" | \"16:9\";\n    x?: number;\n    y?: number;\n  }): Promise<{\n    width: number;\n    height: number;\n    x: number;\n    y: number;\n  }> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video) {\n      throw new Error(\"camera is not running\");\n    }\n\n    if (options.aspectRatio) {\n      const [widthRatio, heightRatio] = options.aspectRatio\n        .split(\":\")\n        .map(Number);\n      // For camera, use portrait orientation: 4:3 becomes 3:4, 16:9 becomes 9:16\n      const ratio = heightRatio / widthRatio;\n\n      // Get current position and size\n      const rect = video.getBoundingClientRect();\n      const currentWidth = rect.width;\n      const currentHeight = rect.height;\n      const currentRatio = currentWidth / currentHeight;\n\n      let newWidth: number;\n      let newHeight: number;\n\n      if (currentRatio > ratio) {\n        // Width is larger, fit by height and center horizontally\n        newWidth = currentHeight * ratio;\n        newHeight = currentHeight;\n      } else {\n        // Height is larger, fit by width and center vertically\n        newWidth = currentWidth;\n        newHeight = currentWidth / ratio;\n      }\n\n      // Calculate position\n      let x: number, y: number;\n      if (options.x !== undefined && options.y !== undefined) {\n        // Use provided coordinates, ensuring they stay within screen boundaries\n        x = Math.max(0, Math.min(options.x, window.innerWidth - newWidth));\n        y = Math.max(0, Math.min(options.y, window.innerHeight - newHeight));\n      } else {\n        // Auto-center the view\n        x = (window.innerWidth - newWidth) / 2;\n        y = (window.innerHeight - newHeight) / 2;\n      }\n\n      video.style.width = `${newWidth}px`;\n      video.style.height = `${newHeight}px`;\n      video.style.left = `${x}px`;\n      video.style.top = `${y}px`;\n      video.style.position = \"absolute\";\n\n      const offsetX = newWidth / 8;\n      const offsetY = newHeight / 8;\n\n      return {\n        width: Math.round(newWidth),\n        height: Math.round(newHeight),\n        x: Math.round(x + offsetX),\n        y: Math.round(y + offsetY),\n      };\n    } else {\n      video.style.objectFit = \"cover\";\n      const rect = video.getBoundingClientRect();\n      const offsetX = rect.width / 8;\n      const offsetY = rect.height / 8;\n\n      return {\n        width: Math.round(rect.width),\n        height: Math.round(rect.height),\n        x: Math.round(rect.left + offsetX),\n        y: Math.round(rect.top + offsetY),\n      };\n    }\n  }\n\n  private createGridOverlay(gridMode: string): HTMLElement {\n    const overlay = document.createElement(\"div\");\n    overlay.style.position = \"absolute\";\n    overlay.style.top = \"0\";\n    overlay.style.left = \"0\";\n    overlay.style.width = \"100%\";\n    overlay.style.height = \"100%\";\n    overlay.style.pointerEvents = \"none\";\n    overlay.style.zIndex = \"10\";\n\n    const divisions = gridMode === \"3x3\" ? 3 : 4;\n\n    // Create SVG for grid lines\n    const svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    svg.style.width = \"100%\";\n    svg.style.height = \"100%\";\n    svg.style.position = \"absolute\";\n    svg.style.top = \"0\";\n    svg.style.left = \"0\";\n\n    // Create grid lines\n    for (let i = 1; i < divisions; i++) {\n      // Vertical lines\n      const verticalLine = document.createElementNS(\n        \"http://www.w3.org/2000/svg\",\n        \"line\",\n      );\n      verticalLine.setAttribute(\"x1\", `${(i / divisions) * 100}%`);\n      verticalLine.setAttribute(\"y1\", \"0%\");\n      verticalLine.setAttribute(\"x2\", `${(i / divisions) * 100}%`);\n      verticalLine.setAttribute(\"y2\", \"100%\");\n      verticalLine.setAttribute(\"stroke\", \"rgba(255, 255, 255, 0.5)\");\n      verticalLine.setAttribute(\"stroke-width\", \"1\");\n      svg.appendChild(verticalLine);\n\n      // Horizontal lines\n      const horizontalLine = document.createElementNS(\n        \"http://www.w3.org/2000/svg\",\n        \"line\",\n      );\n      horizontalLine.setAttribute(\"x1\", \"0%\");\n      horizontalLine.setAttribute(\"y1\", `${(i / divisions) * 100}%`);\n      horizontalLine.setAttribute(\"x2\", \"100%\");\n      horizontalLine.setAttribute(\"y2\", `${(i / divisions) * 100}%`);\n      horizontalLine.setAttribute(\"stroke\", \"rgba(255, 255, 255, 0.5)\");\n      horizontalLine.setAttribute(\"stroke-width\", \"1\");\n      svg.appendChild(horizontalLine);\n    }\n\n    overlay.appendChild(svg);\n    return overlay;\n  }\n\n  async setGridMode(options: { gridMode: GridMode }): Promise<void> {\n    // Web implementation of grid mode would need to be implemented\n    // For now, just resolve as a no-op\n    console.warn(\n      `Grid mode '${options.gridMode}' is not yet implemented for web platform`,\n    );\n  }\n\n  async getGridMode(): Promise<{ gridMode: GridMode }> {\n    // Web implementation - default to none\n    return { gridMode: \"none\" };\n  }\n\n  async getPreviewSize(): Promise<{\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video) {\n      throw new Error(\"camera is not running\");\n    }\n    const offsetX = video.width / 8;\n    const offsetY = video.height / 8;\n\n    return {\n      x: video.offsetLeft + offsetX,\n      y: video.offsetTop + offsetY,\n      width: video.width,\n      height: video.height,\n    };\n  }\n  async setPreviewSize(options: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }): Promise<{\n    width: number;\n    height: number;\n    x: number;\n    y: number;\n  }> {\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video) {\n      throw new Error(\"camera is not running\");\n    }\n    video.style.left = `${options.x}px`;\n    video.style.top = `${options.y}px`;\n    video.width = options.width;\n    video.height = options.height;\n\n    const offsetX = options.width / 8;\n    const offsetY = options.height / 8;\n\n    return {\n      width: options.width,\n      height: options.height,\n      x: options.x + offsetX,\n      y: options.y + offsetY,\n    };\n  }\n\n  async setFocus(options: { x: number; y: number }): Promise<void> {\n    // Reject if values are outside 0-1 range\n    if (options.x < 0 || options.x > 1 || options.y < 0 || options.y > 1) {\n      throw new Error(\"Focus coordinates must be between 0 and 1\");\n    }\n\n    const video = document.getElementById(DEFAULT_VIDEO_ID) as HTMLVideoElement;\n    if (!video?.srcObject) {\n      throw new Error(\"camera is not running\");\n    }\n\n    const stream = video.srcObject as MediaStream;\n    const videoTrack = stream.getVideoTracks()[0];\n\n    if (!videoTrack) {\n      throw new Error(\"no video track found\");\n    }\n\n    const capabilities = videoTrack.getCapabilities() as any;\n\n    // Check if focusing is supported\n    if (capabilities.focusMode) {\n      try {\n        // Web API supports focus mode settings but not coordinate-based focus\n        // Setting to manual mode allows for coordinate focus if supported\n        await videoTrack.applyConstraints({\n          advanced: [\n            {\n              focusMode: \"manual\",\n              focusDistance: 0.5, // Mid-range focus as fallback\n            } as any,\n          ],\n        });\n      } catch (error) {\n        console.warn(\n          `setFocus is not fully supported on this device: ${error}. Focus coordinates (${options.x}, ${options.y}) were provided but cannot be applied.`,\n        );\n      }\n    } else {\n      console.warn(\n        \"Focus control is not supported on this device. Focus coordinates were provided but cannot be applied.\",\n      );\n    }\n  }\n\n  // Exposure stubs (unsupported on web)\n  async getExposureModes(): Promise<{ modes: ExposureMode[] }> {\n    throw new Error(\"getExposureModes not supported under the web platform\");\n  }\n\n  async getExposureMode(): Promise<{ mode: ExposureMode }> {\n    throw new Error(\"getExposureMode not supported under the web platform\");\n  }\n\n  async setExposureMode(_options: { mode: ExposureMode }): Promise<void> {\n    throw new Error(\"setExposureMode not supported under the web platform\");\n  }\n\n  async getExposureCompensationRange(): Promise<{\n    min: number;\n    max: number;\n    step: number;\n  }> {\n    throw new Error(\n      \"getExposureCompensationRange not supported under the web platform\",\n    );\n  }\n\n  async getExposureCompensation(): Promise<{ value: number }> {\n    throw new Error(\n      \"getExposureCompensation not supported under the web platform\",\n    );\n  }\n\n  async setExposureCompensation(_options: { value: number }): Promise<void> {\n    throw new Error(\n      \"setExposureCompensation not supported under the web platform\",\n    );\n  }\n\n  async deleteFile(_options: { path: string }): Promise<{ success: boolean }> {\n    // Mark parameter as intentionally unused to satisfy linter\n    void _options;\n    throw new Error(\"deleteFile not supported under the web platform\");\n  }\n}\n"]}